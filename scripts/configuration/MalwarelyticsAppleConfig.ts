/** Configuration of the Malwarelytics SDK for the Apple platform. */
interface MalwarelyticsAppleConfig {
    /** RASP component configuration. If not set, default values are used. */
    rasp?: MalwarelyticsAppleRaspConfig;
    /** Configuration of the events that are sent to the server. */
    events?: MalwarelyticsAppleEventConfig;
    /** Configuration of customer grouping and naming in the Malwarelytics web console. */
    customerGrouping?: MalwarelyticsAppleCustomerGroupingConfig;
}

/** Configuration of the events collection. */
interface MalwarelyticsAppleEventConfig {
    /** Way to disable event collection in general. The default value is `true`. */
    enableEventCollection?: boolean;
    /** Event will be reported when user takes a screenshot. The default value is `true`. */
    enableScreenshotTakenCollection?: boolean;
}

/** Configuration of customer grouping and naming in the Malwarelytics web console. */
interface MalwarelyticsAppleCustomerGroupingConfig {
    /**
     * Set custom source bundle identifier.
     * The value has to match application credentials defined in the web application.
     *
     * Maximum length of the value is 255 characters.
     */
    sourceBundleId?: string;
    /**
     * Set app bundle identifier to obtain extra granularity
     * of the information displayed in the web application.
     * Distinguishes application purposes or segmentation in one organization.
     *
     * Maximum length of the value is 255 characters.
     */
    appBundleId?: string;
    /**
     * Set audience group ID to obtain extra granularity
     * of the information displayed in the web application.
     * Distinguishes users from different customer systems (RETAIL, CORPORATE, ...).
     *
     * Maximum length of the value is 20 characters.
     */
    audienceGroupId?: string;
}

/** Configuration of the RASP features on the Apple platforms */
interface MalwarelyticsAppleRaspConfig {
    /** Jailbreak detection configuration. The default action is `NOTIFY`. */
    jailbreak?: MalwarelyticsAppleBasicDetectionConfig;
    /** Debugger detection configuration. The default action is `NOTIFY`. */
    debugger?: MalwarelyticsAppleDebuggerDetectionConfig;
    /** everse engineering tools presence detection configuration. The default action is `NOTIFY`. */
    reverseEngineeringTools?: MalwarelyticsAppleBasicDetectionConfig;
    /** HTTP proxy detection configuration. The default action is `NOTIFY`. */
    httpProxy?: MalwarelyticsAppleBasicDetectionConfig;
    /** Repackaging detection configuration. The default action is `NO_ACTION` with empty array of certificates. */
    repackage?: MalwarelyticsAppleRepackageDetectionConfig;
    /** Screen capturing detection. The default action is `NOTIFY`. */
    screenCapture?: MalwarelyticsAppleBasicDetectionConfig;
}

/** Configuration of the debugger detection behavior */
interface MalwarelyticsAppleDebuggerDetectionConfig {
    /** Behavior of the debugger detection */
    action: MalwarelyticsAppleDebuggerDetectionAction;
    /** This URL will be open in the default browser when app is terminated in case that the `action` is `EXIT`. */
    exitUrl?: string;
}

/** Configuration of the repackaging detection behavior */
interface MalwarelyticsAppleRepackageDetectionConfig {
    /** Behavior of the repackaging detection */
    action: MalwarelyticsAppleDetectionAction;
    /** 
     * Trusted certificates for ad-hoc or enterprise distribution.
     * 
     * This is needed only for non-production distribution.
     * 
     * How to retrieve the certificate:
     * 1. Open the Keychain Access application.
     * 2. Find a certificate that will be used to sign your application, for example, “Apple Development: Jan Tester (c)”.
     * 3. Right-click on the item and click “Export…”.
     * 4. Export the certificate in the .cer format.
     * 5. Open up the terminal and cd into the folder with your exported certificate.
     * 6. Encode the certificate in Base64 with cat your_exported.cer | base64.
     */
    base64EncodedTrustedCertificates?: [string];
    /** This URL will be open in the default browser when app is terminated in case that the `action` is `EXIT`. */
    exitUrl?: string;
}

/** Configuration of the basic detection behavior */
interface MalwarelyticsAppleBasicDetectionConfig {
    /** Behavior of the detection */
    action: MalwarelyticsAppleDetectionAction;
    /** This URL will be open in the default browser when app is terminated in case that the `action` is `EXIT`. */
    exitUrl?: string;
}

/**
 * NO_ACTION - do nothing
 * NOTIFY - notify via the observer
 * BLOCK - block the debugger
 * EXIT - exit the app
 */
type MalwarelyticsAppleDebuggerDetectionAction = "NO_ACTION" | "NOTIFY" | "BLOCK" | "EXIT";

/**
 * NO_ACTION - do nothing
 * NOTIFY - notify via the observer
 * EXIT - exit the app
 */
type MalwarelyticsAppleDetectionAction = "NO_ACTION" | "NOTIFY" | "EXIT";